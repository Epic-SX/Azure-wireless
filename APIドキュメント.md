# KoeNote API ドキュメント

## ベースURL
- AWS API Gateway エンドポイント: `https://8dkx06qf3a.execute-api.ap-northeast-1.amazonaws.com/Prod`
- 環境変数: `NEXT_PUBLIC_rePr_wireless_API_URL="https://8dkx06qf3a.execute-api.ap-northeast-1.amazonaws.com/Prod"`

## 録音管理 API エンドポイント

### すべての録音を取得
- **エンドポイント**: `GET /api/koenote/recordings`
- **説明**: すべての録音のリストを取得します
- **レスポンス**: 録音オブジェクトのJSON配列（id、device_id、location、timestamp、level、audio_url、アラート情報などの詳細を含む）

### 録音URL取得
- **エンドポイント**: `GET /api/koenote/recording/[id]/url`
- **説明**: 特定の録音のオーディオファイルにアクセスするための署名付きURLを取得します
- **パラメータ**: 
  - `id` (パスパラメータ): 録音ID
- **レスポンス**: オーディオファイルの`signedUrl`を含むJSONオブジェクト

### 録音詳細取得 (koenoto)
- **エンドポイント**: `GET /api/koenoto/[id]`
- **説明**: 特定の録音に関する詳細情報を取得します
- **パラメータ**:
  - `id` (パスパラメータ): 録音ID
- **レスポンス**: タイトル、日付、時間、文字起こし、要約、キーワードなどの録音詳細を含むJSONオブジェクト

### 録音削除
- **エンドポイント**: `DELETE /api/koenoto/[id]`
- **説明**: 特定の録音を削除します
- **パラメータ**:
  - `id` (パスパラメータ): 録音ID
- **レスポンス**: 成功メッセージ

### ユーザー録音取得
- **エンドポイント**: `GET /api/koenoto`
- **パラメータ**:
  - `user_id` (クエリパラメータ): 録音をフィルタリングするユーザーID
- **説明**: 特定のユーザーのすべての録音を取得します
- **レスポンス**: 録音オブジェクトのJSON配列

### 録音作成
- **エンドポイント**: `POST /api/koenoto`
- **説明**: 新しい録音エントリを作成します
- **リクエストボディ**: 録音の詳細
- **レスポンス**: IDを含む作成された録音オブジェクト

## 音声処理 API エンドポイント

### 音声アップロード
- **エンドポイント**: `POST /api/koenoto/upload-audio`
- **説明**: 処理するための音声ファイルをアップロードします
- **リクエストボディ**: 音声ファイルデータ
- **レスポンス**: アップロードキーと成功ステータスを含むJSONオブジェクト

### 音声処理
- **エンドポイント**: `POST /api/koenoto/process-audio`
- **説明**: 文字起こしと分析のための音声処理を開始します
- **リクエストボディ**: 処理する音声に関する詳細
- **レスポンス**: 処理ステータスを追跡するためのexecutionArnを含むJSONオブジェクト

### 処理ステータス確認
- **エンドポイント**: `GET /api/koenoto/process-status`
- **パラメータ**:
  - `executionArn` (クエリパラメータ): プロセス実行ARN
- **説明**: 音声処理ジョブのステータスを確認します
- **レスポンス**: ステータス情報（実行中/完了）と、完了した場合は結果

### 録音保存
- **エンドポイント**: `POST /api/koenoto/save-recording`
- **説明**: 処理された録音情報を保存します
- **リクエストボディ**: 文字起こし、要約などを含む録音の詳細
- **レスポンス**: 成功ステータスを含む保存された録音オブジェクト

## 備考
- すべてのAPIエンドポイントはバックエンドサービスへのリクエストをプロキシします
- 開発モードでは、バックエンドが利用できない場合にモックデータが返されます
- エラーレスポンスには適切なHTTPステータスコードとエラーメッセージが含まれます 